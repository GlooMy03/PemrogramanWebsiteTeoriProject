<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>About - Mie Gacoan</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/order_style.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="nav">
        <div class="menu-wrap">
            <a href="index.html" class="logo">
                <img src="assets/LogoMieGacoan-removebg-preview.png" alt="Mie Gacoan Logo" />
            </a>
            <div class="menu">
                <a href="index.html" class="menu-item">Home</a>
                <a href="about.html" class="menu-item">About</a>
                <a href="menuUtama.html" class="menu-item">Menu</a>
                <a href="order.html" class="menu-item active">Order</a>
                <a href="contact.html" class="menu-item">Contact</a>
            </div>
            <div class="right-menu">
                <button id="loginBtn" class="login">Login</button>
                <button id="signUpBtn" class="sign-in">Sign In</button>
                <button id="profileBtn" style="display: none;" class="profile">Profile</button>
            </div>
        </div>
    </nav>

    <div class="head_container">
        <div class="mainhead">
            <h1>C A R T</h1>
        </div>
    </div>

    <section class="cart-section">
        <div class="inputForCoupon">
            <label for="couponCodes" id="haveCoupon">Have a Coupon?</label>
            <div class="enterCouponCode">
                <input type="text" name="inputCode" id="inputCode" placeholder="Enter Coupon Code">
                <button id="applyCouponButton" onclick="applyFirstTimeDiscount()">Apply</button>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-md-7">
                <div class="card mb-4 p-3 shadow-sm">
                    <h2 class="playfair">Food Items Ordered</h2>
                    <div class="food-item-list">
                        <ul id="cartItems">
                            
                        </ul>
                        <div class="cart-summary">
                            <div class="subtotal">
                                <span>Subtotal:</span>
                                <span id="subtotal">Rp 0</span>
                            </div>
                            <div class="tax">
                                <span>Tax (10%):</span>
                                <span id="tax">Rp 0</span>
                            </div>
                            <div class="total">
                                <span>Total:</span>
                                <span id="total">Rp0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-5">
                <!-- Checkout Options -->
                <div class="card mb-4 p-3 shadow-sm">
                    <label for="checkoutType" class="form-label">Type of Checkout</label>
                    <select id="checkoutType" class="form-select">
                        <option value="select" selected>-- select --</option>
                        <option value="orderOnline">Order Online</option>
                        <option value="dineInOrder">Dine In Order</option>
                        <option value="takeoutOrder">Take Away Order</option>
                    </select>
                    <div id="info-checkout" class="mt-3"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-info">
                <div class="footer-logo">
                    <img src="assets/LogoMieGacoan-removebg-preview.png" alt="Mie Gacoan">
                </div>
                <p>In the new era of technology we look a in the future with certainty and pride for our company suit.</p>
                <div class="social-links">
                    <a href="#">Twitter</a>
                    <a href="#">Facebook</a>
                    <a href="#">Instagram</a>
                    <a href="#">Pinterest</a>
                </div>
            </div>
            <div class="footer-links">
                <h3>Pages</h3>
                <a href="homepage.html">Home</a>
                <a href="#">About</a>
                <a href="menu.html">Menu</a>
                <a href="#">Pricing</a>
                <a href="#">Blog</a>
            </div>
            <div class="footer-links">
                <h3>Utility Pages</h3>
                <a href="#">Start Here</a>
                <a href="#">Styleguide</a>
                <a href="#">Password Protected</a>
                <a href="#">404 Not Found</a>
                <a href="#">Licenses</a>
            </div>
        </div>
    </footer>

    <script src="../js/order.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Function to check if the user is logged in
        function checkLoginStatus() {
            const user = sessionStorage.getItem('user');  // Check in sessionStorage

            if (user) {
                // If user is logged in, hide login and sign up buttons, show profile button
                document.getElementById('loginBtn').style.display = 'none';
                document.getElementById('signUpBtn').style.display = 'none';
                document.getElementById('profileBtn').style.display = 'block';
            } else {
                // If user is not logged in, show login and sign up buttons
                document.getElementById('loginBtn').style.display = 'block';
                document.getElementById('signUpBtn').style.display = 'block';
                document.getElementById('profileBtn').style.display = 'none';
            }
        }
        
        function submitOrder() {
    const user = sessionStorage.getItem('user');  // Pastikan pengguna login
    if (!user) {
        alert("Please login to place an order");
        return;
    }

    // Mengambil data keranjang dari localStorage
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    if (cart.length === 0) {
        alert("Your cart is empty. Please add items to your cart before placing an order.");
        return;
    }

    // Menyusun data pesanan yang akan dikirim ke server
    const orderData = {
        userId: user,  // ID pengguna dari sessionStorage
        items: cart.map(item => ({
            menuId: item.id,
            name: item.name,
            quantity: item.quantity,
            price: item.price
        })),
        totalAmount: cart.reduce((total, item) => total + (item.quantity * item.price), 0),
        orderType: document.getElementById('orderType').value,  // Mengambil tipe pemesanan dari form
        reservationName: document.getElementById('reservationName').value,  // Nama reservasi (opsional)
        numberOfPeople: document.getElementById('numberOfPeople').value,  // Jumlah orang (opsional)
        arrivalTime: document.getElementById('arrivalTime').value  // Waktu kedatangan (opsional)
    };

    // Mengirim data pesanan ke server (process_order.php)
    fetch('process_order.php', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(orderData)
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('Order placed successfully!');
            // Hapus keranjang setelah pemesanan berhasil
            localStorage.removeItem('cart');
        } else {
            alert('Failed to place order.');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('An error occurred while placing your order.');
    });
}



        // Call checkLoginStatus function when the page loads
        window.addEventListener('DOMContentLoaded', checkLoginStatus);
    </script>
</body>
</html>
